<div class="main-content">
  <div class="contact-header">
    <h1>{{ translations.header[currentLang] }}</h1>
  </div>

  <div class="contentContainer">
    <div class="text-content">
      <div>
        <h2>{{ translations.subheader[currentLang] }}</h2>
        <span>{{ translations.description[currentLang] }}</span>
      </div>
    </div>
    <div class="contact-form">
      <form (ngSubmit)="onSubmit(contactForm)" #contactForm="ngForm" novalidate>
        <div class="personal-group">
          <div class="form-group">
            <label for="name">{{ translations.labels.name[currentLang] }}</label>
            <input #name="ngModel" [(ngModel)]="contactData.name" name="name" id="name" type="text" required
              minlength="3" pattern="^(?!\s*$)[A-Za-zÄÖÜäöüß]+(?: [A-Za-zÄÖÜäöüß]+)?$" autocomplete="off"
              [placeholder]="translations.placeholders.name[currentLang]"
              [class.is-error]="shouldShowError('name', name)" (blur)="blurredFields.name = true"
              (focus)="blurredFields.name = false" />
            <div class="error-popup-name" *ngIf="shouldShowError('name', name)" [@fadeInOut]>
              <ng-container *ngIf="name.errors?.['required']">
                <p>{{ translations.errorPlaceholders.name.empty[currentLang] }} </p>
              </ng-container>
              <ng-container *ngIf="name.errors?.['minlength']">
                <p>{{ translations.errorPlaceholders.name.tooShort[currentLang] }}</p>
              </ng-container>
              <ng-container *ngIf="name.errors?.['pattern']">
                <p>{{ translations.errorPlaceholders.name.invalidChars[currentLang] }}</p>
              </ng-container>
            </div>
          </div>
          <div class="form-group">
            <label for="email">{{ translations.labels.email[currentLang] }}</label>
            <input #email="ngModel" [(ngModel)]="contactData.email" name="email" id="email" type="text" required
              pattern="^(?!\s)[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[A-Za-z]{2,}$" autocomplete="off"
              [placeholder]="translations.placeholders.email[currentLang]"
              [class.is-error]="shouldShowError('email', email)" (blur)="blurredFields.email = true"
              (focus)="blurredFields.email = false" />
            <div class="error-popup-mail" *ngIf="shouldShowError('email', email)" [@fadeInOut]>
              <ng-container *ngIf="email.errors?.['required']">
                <p>{{ translations.errorPlaceholders.email.empty[currentLang] }}</p>
              </ng-container>
              <ng-container *ngIf="email.errors?.['pattern'] || email.errors?.['email']">
                <p>{{ translations.errorPlaceholders.email.invalidFormat[currentLang] }}</p>
              </ng-container>
            </div>
          </div>
        </div>
        <div class="message-group">
          <label for="message">{{ translations.labels.message[currentLang] }}</label>
          <textarea #message="ngModel" [(ngModel)]="contactData.message" name="message" id="message" rows="1" required
            minlength="4" pattern="^(?!\s)[\s\S]{4,}$" autocomplete="off"
            [placeholder]="translations.placeholders.message[currentLang]"
            [class.is-error]="shouldShowError('message', message)" (blur)="blurredFields.message = true"
            (focus)="blurredFields.message = false">
          </textarea>
          <div class="error-popup-message" *ngIf="shouldShowError('message', message)" [@fadeInOut]>
            <ng-container *ngIf="message.errors?.['required']">
              <p>{{ translations.errorPlaceholders.message.empty[currentLang] }}</p>
            </ng-container>
            <ng-container *ngIf="message.errors?.['minlength']">
              <p>{{ translations.errorPlaceholders.message.tooShort[currentLang] }}</p>
            </ng-container>
            <ng-container *ngIf="message.errors?.['pattern']">
              <p>{{ translations.errorPlaceholders.message.leadingSpace[currentLang] }}</p>
            </ng-container>
          </div>
        </div>
        <!-- ... deine bisherigen Inputfelder (name, email, message) bleiben unverändert ... -->

<!-- ✅ Agreement (Checkbox mit Custom-Icons + Error + Validation) -->
<div class="agreement-group">
  <div class="agreement">
    <span>
      {{ translations.checkbox[currentLang].before }}
      <a (click)="navigateAndScroll(['/legal', 'privacy-policy'])">
        {{ translations.checkbox[currentLang].link }}
      </a>
      {{ translations.checkbox[currentLang].after }}
    </span>
  </div>

 <div class="checkbox-wrapper">
  <!-- Unsichtbare echte Checkbox -->
  <input
    [(ngModel)]="contactData.agreement"
    #agreement="ngModel"
    name="agreement"
    id="agreementbox"
    type="checkbox"
    required
    class="checkbox-hidden"
    (change)="onInputChange('agreement')"
    (blur)="blurredFields.agreement = true"
  />

  <!-- Label, das den Input referenziert -->
  <label
    for="agreementbox"
    class="custom-checkbox"
    [class.checked]="contactData.agreement"
  >
    <img
      *ngIf="!contactData.agreement"
      src="../assets/img/unchecked.png"
      alt="unchecked"
    />
    <img
      *ngIf="contactData.agreement"
      src="../assets/img/checked.png"
      alt="checked"
    />
  </label>

  <!-- Fehleranzeige -->
  <div class="error-popup-agreement" *ngIf="shouldShowError('agreement', agreement)" [@fadeInOut]>
    <p>{{ checkboxHint }}</p>
  </div>
</div>

</div>

<div class="submit-wrapper">
  <button
    type="button"
    class="submit-btn"
    [class.disabled]="contactForm.invalid"
    (click)="handleSubmitClick(contactForm)"
  >
    {{ translations.submit[currentLang] }}
  </button>

  <div
    class="checkbox-tooltip"
    *ngIf="isFormAlmostValid || isSuccess"
    [class.success]="isSuccess"
  >
    {{ isSuccess ? successHint : checkboxHint }}
  </div>
</div>


      </form>
    </div>
  </div>
</div>
<div class="arrow-wrapper">
  <div class="borderBox">
    <img src="assets/icons/arrow2.png" alt="Back to top" class="bounce-arrow" (click)="scrollToHero()" />
  </div>
</div>